---
title: "ã€AWS S3ã€‘ Python boto3 or AWS CLI"
emoji: "ğŸ”„"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [aws, S3, Python, boto3, Docker]
published: false
---

## ã¯ã˜ã‚ã«
AWS S3 ã§ ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ã€æŒ‡å®šæ—¥ä»¥é™ã§å–ã‚Šå‡ºã™ã«ã¯ã©ã†ã™ã‚‹ã‹æ¤œè¨ã—ã¦ã¿ã‚‹

## çµè«–
`system timestamp` ã‚’å–å¾—ã—ãŸã„æ™‚ã¯ã€`boto3`ã§ã¯å–å¾—ã§ããªã„ã®ã§ã€`AWS CLI`ã§å¯¾å¿œã™ã‚‹

## ã‚„ã‚ŠãŸã„ã“ã¨
s3 ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€æŒ‡å®šæ—¥ä»˜ä»¥é™ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—ã—ãŸã„

## å‡¦ç†ãƒ•ãƒ­ãƒ¼

1. `$ aws s3 ls` ã§IFé€£æºãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å–å¾—
2. loopå‡¦ç†ã§ã€å„ãƒ•ã‚©ãƒ«ãƒ€å˜ä½ã”ã¨ã«ã€`$ aws s3 ls`
3. [snowflake é€£æºã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†TBL] ã‹ã‚‰ã€éå»1é€±é–“å‰ã®å‡¦ç†æ™‚é–“ã‚’å–å¾—ã™ã‚‹
4. å–å¾—æ¸ˆã¿ã¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€[snowflake é€£æºã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†TBL] ã«å–å¾—æ¸ˆã¿ã¨ã—ã¦ä¿å­˜ã™ã‚‹
5.

## ã§ããŸã“ã¨

## ã§ããªã‹ã£ãŸã“ã¨

## ã¾ã¨ã‚

## AWS CLI ã‚³ãƒãƒ³ãƒ‰

### aws s3 ls

- æ ¼ç´bucketå: `testbucket-yyyymmdd`

**æ¤œç´¢ã§ãã‚‹**
```bash:AWS CLI

$ aws s3 ls | grep testb
2021-10-28 23:49:00 testbucket-yyyymmdd

$ aws s3 ls | grep d$
2021-10-28 23:49:00 testbucket-yyyymmdd

$ aws s3 ls | grep ^20
2021-10-28 23:49:00 testbucket-yyyymmdd

$ aws s3 ls | grep ^2021-10-28
2021-10-28 23:49:00 testbucket-yyyymmdd

$ aws s3 ls | grep 23:49
2021-10-28 23:49:00 testbucket-yyyymmdd

$ aws s3 ls | grep t-..y...dd
2021-10-28 23:49:00 testbucket-yyyymmdd
```

**æ¤œç´¢ã§ããªã„**
```bash:AWS CLI
$ aws s3 ls | grep test$

$ aws s3 ls | grep ^test$

$ aws s3 ls | grep ^test

$ aws s3 ls | grep ^2021-10-29

```

### aws s3 mv

- local file ã‚’æŒ‡å®šbucket ã«ç§»ã™
- ç§»ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€s3 ã«ç§»ã—ãŸã®å­˜åœ¨ã—ãªã„


```bash:AWS CLI
# syntax
$ aws s3 mv <local file path> <s3://<bucket name>>
```

```bash:AWS CLI
$ aws s3 mv models/storage.py s3://bucket1-name
# Output:
move: models/storage.py to s3://bucket1-name/storage.py
```

- s3 ã‹ã‚‰ local ã¸ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•

```bash:AWS CLI
# syntax
$ aws s3 mv <s3://<bucket name>> <local file path>
```

```bash:AWS CLI
$ aws s3 mv s3://bucket1-name/storage.py .
# Output:
move: s3://bucket1-name/storage.py to ./storage.py

```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³

- `--human-readable`: ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’Bytes/MiB/KiB/GiB/TiB/PiB/EiBã§è¡¨ç¤º
- `--summarize`: çµæœãƒªã‚¹ãƒˆã®æœ€å¾Œã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç·æ•°ã¨ã‚µã‚¤ã‚ºã®åˆè¨ˆã‚’è¡¨ç¤º

```bash:AWS CLI
$ aws s3 ls s3://bucket1-name --human-readable --summarize
2021-10-30 08:36:57    7.4 KiB storage.py

Total Objects: 1
   Total Size: 7.4 KiB
```

## å‚è€ƒ
- [AWS CLI ã§ã®é«˜ãƒ¬ãƒ™ãƒ« (S3) ã‚³ãƒãƒ³ãƒ‰ã®ä½¿ç”¨](https://docs.aws.amazon.com/ja_jp/cli/latest/userguide/cli-services-s3-commands.html)
